<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Theophylline Pharmacokinetic Simulator (ODE-Based)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
                         Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px 16px 40px;
            line-height: 1.6;
            color: #222;
            background-color: #fafafa;
        }
        h1, h2, h3 {
            color: #111;
        }
        code {
            font-family: "Fira Code", "Consolas", "Courier New", monospace;
            background: #f2f2f2;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.95em;
        }
        pre {
            background: #f2f2f2;
            padding: 10px 12px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 0.95em;
        }
        .tagline {
            color: #555;
            font-size: 0.98em;
        }
        ul {
            margin-top: 0;
        }
        hr {
            margin: 24px 0;
        }
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            background: #e3f2fd;
            color: #0d47a1;
            margin-right: 6px;
        }
    </style>
</head>
<body>

    <h1>Theophylline Pharmacokinetic Simulator (ODE-Based)</h1>
    <p class="tagline">
        An interactive pharmacokinetic simulator using ordinary differential equations (ODEs),
        RK4 numerical integration, and real clinical Theophylline data.
    </p>

    <hr>

    <h2>Overview</h2>
    <p>
        This project models the plasma concentration of Theophylline after oral administration
        using a one-compartment pharmacokinetic model with first-order absorption and
        elimination. The model is calibrated on a real clinical dataset and solved
        numerically with a fourth-order Runge&ndash;Kutta (RK4) method. An interactive
        <strong>Streamlit</strong> interface allows users to explore different dosing
        regimens and automatically receive a recommended fixed-interval schedule based on
        time spent within the therapeutic window.
    </p>

    <h2>Features</h2>
    <ul>
        <li>One-compartment ODE model with first-order absorption and elimination.</li>
        <li>Model parameters calibrated using real Theophylline concentration data.</li>
        <li>Numerical solution via fixed-step RK4 with high temporal resolution.</li>
        <li>Multi-dose simulation with user-controlled:
            <ul>
                <li>Dose per administration</li>
                <li>Dose interval</li>
                <li>Number of doses</li>
                <li>Total simulation time</li>
            </ul>
        </li>
        <li>Automatic computation of:
            <ul>
                <li>Maximum and minimum concentration (C<sub>max</sub>, C<sub>min</sub>)</li>
                <li>Time above MEC (10 mg/L) and above MTC (20 mg/L)</li>
                <li>Total time spent inside the therapeutic window (10&ndash;20 mg/L)</li>
            </ul>
        </li>
        <li>Fixed-interval recommendation engine that:
            <ul>
                <li>Scans candidate intervals</li>
                <li>Rejects toxic regimens (C &gt; MTC)</li>
                <li>Selects the schedule with maximum time in the therapeutic window</li>
            </ul>
        </li>
        <li>Fully interactive web app built with Streamlit.</li>
    </ul>

    <h2>Repository Structure</h2>
    <pre><code>theophylline-pk-ode-simulator/
├── src/
│   └── pk_interactive_app.py
├── report/
│   ├── final_report.pdf
│   └── report_source.tex
├── plots/
│   └── example_output.png
├── requirements.txt
├── README.md
└── LICENSE
</code></pre>

    <p><em>Note:</em> Folder names are suggestions; you can adjust them to match your actual layout.</p>

    <h2>Installation</h2>

    <h3>1. Clone the repository</h3>
    <pre><code>git clone https://github.com/&lt;your-username&gt;/theophylline-pk-ode-simulator.git
cd theophylline-pk-ode-simulator
</code></pre>

    <h3>2. Install dependencies</h3>
    <p>All required Python libraries are listed in <code>requirements.txt</code>:</p>
    <pre><code>pip install -r requirements.txt
</code></pre>

    <h2>Running the Streamlit App</h2>
    <p>From the project root directory, run:</p>
    <pre><code>streamlit run src/pk_interactive_app.py
</code></pre>

    <p>
        This will start the Streamlit server and open the interactive simulator
        in your web browser. From there, you can:
    </p>
    <ul>
        <li>Choose dose amount, dosing interval, number of doses, and total time.</li>
        <li>Visualise the resulting concentration&ndash;time curve.</li>
        <li>Compare the simulated regimen to the calibrated single-dose curve and real data points.</li>
        <li>View key metrics such as C<sub>max</sub>, C<sub>min</sub>, and time in the therapeutic window.</li>
        <li>See an automatically generated fixed-interval dosing recommendation.</li>
    </ul>

    <h2>Dataset</h2>
    <p>
        The project uses the publicly available <strong>Theoph</strong> dataset included in
        the R <code>datasets</code> package. It contains plasma Theophylline concentrations
        measured at multiple time points after a single oral dose in several subjects.
    </p>
    <ul>
        <li>Dataset reference: <code>Theoph</code> (R <code>datasets</code> package)</li>
        <li>CSV link used in the code:<br>
            <a href="https://raw.githubusercontent.com/vincentarelbundock/Rdatasets/master/csv/datasets/Theoph.csv" target="_blank">
                https://raw.githubusercontent.com/vincentarelbundock/Rdatasets/master/csv/datasets/Theoph.csv
            </a>
        </li>
    </ul>
    <p>
        The application automatically downloads and processes this dataset at runtime;
        no manual download is required.
    </p>

    <h2>Technical Details</h2>
    <ul>
        <li>Model type: one-compartment, first-order absorption and elimination.</li>
        <li>Calibration: non-linear least squares fit of parameters
            (S, k<sub>a</sub>, k<sub>e</sub>) to the mean concentration&ndash;time curve.</li>
        <li>Solver: custom fixed-step RK4 implementation with time step
            <code>dt = 0.02</code> hours.</li>
        <li>Therapeutic window:
            <ul>
                <li>MEC (Minimum Effective Concentration) = 10 mg/L</li>
                <li>MTC (Maximum Tolerated Concentration) = 20 mg/L</li>
            </ul>
        </li>
        <li>Recommendation engine: scans fixed intervals between 3.0 and 12.5 hours and
            selects the safe regimen that maximises total time in the therapeutic window.
        </li>
    </ul>

    <h2>Requirements</h2>
    <p>The project depends on the following Python packages:</p>
    <pre><code>numpy
pandas
matplotlib
scipy
streamlit
requests
</code></pre>

    <h2>Report</h2>
    <p>
        A detailed academic report describing the model, numerical methods, calibration
        process, and interactive interface is included in the <code>report/</code> directory.
        It covers the ODE formulation, RK4 implementation, therapeutic window analysis
        and the fixed-interval recommendation engine.
    </p>

    <h2>Author</h2>
    <p>
        <strong>Anirudh Jain, Ayush Pandey, Sourabh, Vedant Kumar</strong><br>
        Cluster Innovation Centre, University of Delhi
    </p>

</body>
</html>
